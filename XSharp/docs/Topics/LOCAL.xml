<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>LOCAL</title>
  <keywords>
    <keyword>IMPLIED</keyword>
    <keyword>LOCAL</keyword>
    <keyword>STATIC</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">LOCAL</para>
    </header>
    <para styleclass="NotesBox">Local declarations can appear anywhere in your code, and do not have to be the first lines in a statement block.</para>
    <para styleclass="NotesBox">Locals declared within a block are only visible inside that block.</para>
    <para styleclass="NotesBox">The VAR keyword has been added for ease of use, and because sometimes the type is difficult to specify, like in the area if LINQ or when anonymous types are used.</para>
    <para styleclass="Heading2">Purpose</para>
    <para styleclass="Body Text">Declare and initialize local variables and arrays.</para>
    <para styleclass="Heading2">Syntax</para>
    <para styleclass="Body Text">[STATIC] LOCAL &lt;idVar&gt; [:= &lt;expression&gt;] [,...] [AS | IS &lt;idType&gt;] [, ...]</para>
    <para styleclass="Body Text">[STATIC] LOCAL DIM &lt;ArraySpec&gt; [, ...] AS | IS &lt;idType&gt; [, ...]</para>
    <para styleclass="Body Text">[STATIC] LOCAL &lt;ArraySpec&gt; [, ...] [AS ARRAY] [, ...]</para>
    <para styleclass="Body Text">VAR &lt;idVar&gt; := &lt;expression&gt;</para>
    <para styleclass="Body Text">LOCAL IMPLIED &lt;idVar&gt; := &lt;expression&gt;</para>
    <para styleclass="Body Text"><text style="font-weight:bold; font-style:italic;">Note</text>: The LOCAL statement is shown using several syntax diagrams for convenience. You can declare variables, dynamic arrays, and dimensioned arrays using a single LOCAL statement if each definition is separated by a comma.</para>
    <para styleclass="Heading2">Arguments</para>
    <para styleclass="List">STATIC<tab />Causes the local variable to retain its value across invocations of the declaring entity but does not affect its visibility.</para>
    <para styleclass="List">&lt;idVar&gt;<tab />A valid identifier name for the local variable to declare.</para>
    <para styleclass="List">&lt;expression&gt;<tab />The initial value to assign to the variable.<br/>For LOCAL, this can be any valid expression.<br/>For STATIC LOCAL, this value can be a literal representation of one of the data types listed below or a simple expression involving only operators, literals, and DEFINE constants; however, more complicated expressions (including class instantiation) are not allowed.<br/>If &lt;uValue&gt; is not specified, the initial value of the variable depends on the data type you declare (e.g., NIL if you do not use strong typing, 0 for AS INT, etc.)</para>
    <para styleclass="List"><text styleclass="Body Text">VAR</text><tab /><text styleclass="Normal">The compiler will calculate the type based on the expression in &lt;uValue&gt;</text></para>
    <para styleclass="List"><text styleclass="Body Text">LOCAL IMPLIED</text><tab /><text styleclass="Normal">The compiler will calculate the type based on the expression in &lt;uValue&gt;</text></para>
    <para styleclass="Body Text">DIM &lt;ArraySpec&gt;<tab />The specification for a dimensioned array to declare.</para>
    <para styleclass="List"><text styleclass="Body Text">&lt;ArraySpec&gt;</text><tab /><text styleclass="Body Text">The specification for a dynamic array to declare.</text><br/><text styleclass="Body Text">In both cases, &lt;ArraySpec&gt; is one of the following:</text></para>
    <para styleclass="List"><tab /><text styleclass="Body Text">&lt;idArray&gt;[&lt;nElements&gt;, &lt;nElements&gt;, &lt;nElements&gt;]</text></para>
    <para styleclass="List"><tab /><text styleclass="Body Text">&lt;idArray&gt;[&lt;nElements&gt;][&lt;nElements&gt;][&lt;nElements&gt;]</text></para>
    <para styleclass="List"><tab /><text styleclass="Body Text">All dimensions except the first are optional.</text></para>
    <para styleclass="List"><tab /><text styleclass="Body Text">&lt;idArray&gt; is a valid identifier name for the array to declare. For dynamic arrays, array elements are initialized to NIL. For dimensioned arrays, the initial value of the elements depends on the data type as explained above for &lt;uValue&gt;.</text></para>
    <para styleclass="List"><tab /><text styleclass="Body Text">&lt;nElements&gt; defines the number of elements in a particular dimension of an array. The number of dimensions is determined by how many &lt;nElements&gt; arguments you specify.</text></para>
    <para styleclass="List"><tab /><text styleclass="Body Text">&lt;nElements&gt; can be a literal numeric representation or a simple numeric expression involving only operators, literals, and DEFINE constants; however, more complicated expressions (such as function calls) are not allowed.</text></para>
    <para styleclass="List">AS &lt;idType&gt;<tab />Specifies the data type of whatever you are declaring (called strong typing). For DIM arrays, declares the data type for all array elements.</para>
    <para styleclass="List">IS &lt;idType&gt;<tab />Specifies a structure data type in which the memory needed to hold the structure is allocated on the stack (&lt;idStructure&gt; is the only &lt;idType&gt; allowed with the IS keyword.) See the STRUCTURE entry in this guide for more information on data structure memory allocation.</para>
    <para styleclass="List"><text styleclass="Body Text">AS ARRAY</text><tab /><text styleclass="Body Text">For dynamic array declarations, specifies the data type of the entire array</text></para>
    <para styleclass="Heading2">Description</para>
    <para styleclass="Body Text">LOCAL is a declaration statement that declares one or more variables or arrays as local to the current routine (i.e., function, method, or procedure). Like other variable declaration statements (such as FIELD and MEMVAR), you must place LOCAL statements before any executable statements (including PRIVATE, PUBLIC, and PARAMETERS) in the routine you are defining.</para>
    <para styleclass="Body Text">Local variable declarations hide all inherited private variables, visible public variables, instance variables, global variables, and constants with the same name. <br/>The search order for a variable name is as follows:</para>
    <para styleclass="Body Text">1.<tab />LOCALs, local parameters, MEMVARs, and FIELDs</para>
    <para styleclass="Body Text">2.<tab />SELF instance variables (i.e., without &lt;idObject&gt;: prefix in class methods)</para>
    <para styleclass="Body Text">3.<tab />GLOBALs and DEFINEs</para>
    <para styleclass="Body Text">A LOCAL statement that declares a variable name which is already declared within the same routine (with FIELD, LOCAL, or MEMVAR) causes a compiler error.</para>
    <para styleclass="Body Text">Local variables are visible only within the current routine, and unlike private variables, are not visible within invoked routines. If a routine is invoked recursively, each recursive activation creates a new set of local variables.</para>
    <para styleclass="Body Text">Unless you specify the STATIC keyword, local variables are created automatically each time the routine in which they were declared begins executing. They continue to exist and retain their values until the declaring routine returns control to the routine that invoked it.</para>
    <para styleclass="Body Text">The STATIC keyword serves as a lifetime modifier for a local variable, preventing the variable from being released from memory when the creating entity returns to its calling routine.</para>
    <para styleclass="Body Text"><text style="font-weight:bold; font-style:italic;">Important</text>! When an application containing static variable declarations is invoked, the variables are created and initialized before the beginning of program execution. Thus, initial values are assigned only once per application run, not each time the creator is called.</para>
    <para styleclass="Body Text">For more information on variable declarations and scoping, refer to the &quot;Variables, Constants, and Declarations&quot; chapter in the Programmer&apos;s Guide.</para>
    <para styleclass="Heading2">Notes</para>
    <para styleclass="Body Text">Local parameters: The FUNCTION, METHOD, and PROCEDURE statements allow you to declare a list of local parameters enclosed in parentheses following the entity name. For example:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; color:#000000;"> &lt;idFunction&gt;(&lt;idParamList&gt;)</text></para>
    <para styleclass="Body Text">Exporting locals through code blocks: When you create a code block, you can access local variables defined in the creating entity within the code block definition without passing them as parameters (because local variables are visible to the code block). This, along with the fact that you can pass a code block as a parameter, allows you to export local variables. For example:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; color:#000000;"> One() </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">EXPORT</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> nVar := 10 </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INT</text><text style="font-weight:normal; font-style:normal; color:#000000;">, cbAdd </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;"> CODEBLOCK</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">cbAdd := {|nValue| nValue + nVar}</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">? NextFunc(cbAdd) </text><text style="font-weight:bold; font-style:italic; color:#339966;">// Result: 210</text><br/><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; color:#000000;"> NextFunc(cbAddEmUp)</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; color:#000000;"> EVAL(cbAddEmUp, 200)</text></para>
    <para styleclass="Body Text">When the code block is evaluated in NextFunc(), nVar, which is local to function One(), becomes visible even though it is not passed directly as a parameter.</para>
    <para styleclass="Body Text">Macro expressions: You cannot refer to local variables within macro variables and expressions. If you refer to a local variable within a macro variable, a private or public variable with the same name will be referenced instead. If no such variable exists, a runtime error will be raised.</para>
    <para styleclass="Body Text">Type of a local variable: Since Type() uses the macro operator (&amp;) to evaluate its argument, you cannot use it to determine the type of a local variable or an expression containing a local variable reference. You can, however, use ValType() which evaluates its argument and returns the type of the return value.</para>
    <para styleclass="Body Text">Memory files: You cannot SAVE or RESTORE local variables.</para>
    <para styleclass="Heading2">Examples</para>
    <para styleclass="Body Text">The following example declares two local arrays and two local variables:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aArray1[20, 10], aArray2[20][10], var1, var2</text></para>
    <para styleclass="Body Text">This example declares two local variables with initializers. The first is initialized to a date value and the second to an array:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> dWhen := TODAY()</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aVegies := {&quot;Tomato&quot;, &quot;Chickadee&quot;, &quot;Butterbean&quot;}</text></para>
    <para styleclass="Body Text">In this example, the variable x and the dimensioned array z are typed as INT, while the variables cName and cAddr are typed as STRING:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x, </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">DIM</text><text style="font-weight:normal; font-style:normal; color:#000000;"> z[100] </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">INT</text><text style="font-weight:normal; font-style:normal; color:#000000;">, cName, cAddr </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">AS</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">STRING</text></para>
    <para styleclass="Body Text">The next example declares static variables both with and without initializers:</para>
    <para styleclass="Code Example"><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">STATIC</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aArray1[20, 10], aArray2[20][10]</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">STATIC</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> cVar, cVar2</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">STATIC</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> cString := &quot;my string&quot;, </text><text style="font-weight:bold; font-style:normal; color:#ff0000;">var</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">STATIC</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aArray := {1, 2, 3}</text></para>
    <para styleclass="Body Text">Here a static variable is manipulated within a function. In this example, a count variable increments itself each time the function is called:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">FUNCTION</text><text style="font-weight:normal; font-style:normal; color:#000000;"> MyCounter(nNewValue)</text><br/><text style="font-weight:bold; font-style:italic; color:#339966;">// Initial value assigned once</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">STATIC</text><text style="font-weight:normal; font-style:normal; color:#000000;">&#32;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">LOCAL</text><text style="font-weight:normal; font-style:normal; color:#000000;"> nCounter := 0</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">IF</text><text style="font-weight:normal; font-style:normal; color:#000000;"> nNewValue != NIL</text><br/><tab /><text style="font-weight:bold; font-style:italic; color:#339966;">// New value for nCounter</text><br/><tab /><text style="font-weight:normal; font-style:normal; color:#000000;">nCounter := nNewValue</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ELSE</text><br/><tab /><text style="font-weight:bold; font-style:italic; color:#339966;">// Increment nCounter</text><br/><tab /><text style="font-weight:normal; font-style:normal; color:#000000;">++nCounter</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">ENDIF</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">RETURN</text><text style="font-weight:normal; font-style:normal; color:#000000;"> nCount</text><text styleclass="Body Text">er</text></para>
    <para styleclass="Body Text">The following code initializes a local with a Generic List and lets the compiler detect the type of the local variable</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">VAR</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aList := List&lt;</text><text style="font-weight:bold; font-style:normal; color:#ff0000;">STRING</text><text style="font-weight:normal; font-style:normal; color:#000000;">&gt;{}</text></para>
    <para styleclass="Heading2">See Also</para>
    <para styleclass="Body Text"><link displaytype="text" defaultstyle="true" type="topiclink" href="FIELD">FIELD</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="Function2">FUNCTION</link>, DEFINE, <link displaytype="text" defaultstyle="true" type="topiclink" href="GLOBAL">GLOBAL</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="MEMVAR">MEMVAR</link>, METHOD, <link displaytype="text" defaultstyle="true" type="topiclink" href="Procedure2">PROCEDURE</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="STATIC">STATIC</link></para>
    <para styleclass="Body Text"></para>
  </body>
</topic>
