<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" lasteditedby="robert" version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title>PUBLIC</title>
  <keywords>
    <keyword>PUBLIC</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1">PUBLIC</para>
    </header>
    <para styleclass="NotesBox">The PUBLIC statement is NOT available in the Core and Vulcan dialects and will only be enabled if the <link displaytype="text" defaultstyle="true" type="topiclink" href="opt-memvar">-memvar</link> commandline option is specified.</para>
    <para styleclass="Heading2">Purpose</para>
    <para styleclass="Body Text">Creates variables and arrays visible to all routines in an application.</para>
    <para styleclass="Heading2">Syntax</para>
    <para styleclass="Body Text">PUBLIC &lt;idVar&gt; [:= &lt;uValue&gt;] [, ...]</para>
    <para styleclass="Heading2">Arguments</para>
    <para styleclass="List">&lt;idVar&gt;<tab />A valid identifier name for the public variable to create.</para>
    <para styleclass="List">&lt;uValue&gt;<tab />The initial value to assign to the variable. This can be any valid expression. If &lt;uValue&gt; is not specified, the variable is initialized to FALSE</para>
    <para styleclass="Heading2">Description</para>
    <para styleclass="Body Text">Any declared variables, such as LOCALs, with the same names as existing public or private variables temporarily hide the public or private variables until the overriding variables are released or are no longer visible.</para>
    <para styleclass="Body Text">An attempt to create a public variable with the same name as an existing and visible private variable is simply ignored; however the assignment portion of the PUBLIC statement is not ignored. For example, the following lines of code change the value of the variable x but do not change its scope from private to public:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">PRIVATE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x := 1000</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">...</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x := &quot;New value for x&quot;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">? x </text><text style="font-weight:bold; font-style:italic; color:#339966;">// Result: &quot;New value for x&quot;</text></para>
    <para styleclass="Body Text">The explanation for this behavior is that, internally, the PUBLIC statement and the assignment are treated as separate statements. Thus, this code would be treated as follows:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">PRIVATE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x := 1000</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">...</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">x := &quot;New value for x&quot;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">? x </text><text style="font-weight:bold; font-style:italic; color:#339966;">// Result: &quot;New value for x&quot;</text></para>
    <para styleclass="Body Text">The PUBLIC statement is ignored, but the assignment statement is executed, changing the value of the private variable x.</para>
    <para styleclass="Body Text">This behavior has an interesting repercussion when you declare a public array using a variable name that already exists as private. For example:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">PRIVATE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x := 1000</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">...</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x[10]</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">? x[1] </text><text style="font-weight:bold; font-style:italic; color:#339966;">// Result: NIL</text></para>
    <para styleclass="Body Text">In this case, the PUBLIC statement is also treated as two separate statements:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">PRIVATE</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x := 1000</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">...</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> x</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">x := ArrayNew(10)</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">? x[1] </text><text style="font-weight:bold; font-style:italic; color:#339966;">// Result: NIL</text></para>
    <para styleclass="Body Text">Again, the PUBLIC statement is ignored, and the assignment changes x from a private numeric variable to a private reference to a ten element array.</para>
    <para styleclass="Body Text">Attempting to specify a public variable that conflicts with a visible declared variable (for example, LOCAL, GLOBAL, or DEFINE) of the same name is not recognized by the compiler as an error because PUBLIC is not a compiler declaration statement. Instead, the declared variable will hide the public variable at runtime. This means that you will not be able to access the public variable at all until the declared variable is released.</para>
    <para styleclass="Body Text">In class methods, instance variables (with the exception of access/assign variables) are always more visible than public variables of the same name. Use the _MEMVAR-&gt; alias to access a public variable within a method if there is a name conflict. For access/assign variables, use the SELF: prefix to override a name conflict with a public variable.</para>
    <para styleclass="Body Text">Public variables are dynamically scoped. They exist for the duration of the application or until explicitly released with CLEAR ALL or CLEAR MEMORY.</para>
    <para styleclass="Heading2">Notes</para>
    <para styleclass="Body Text"></para>
    <para styleclass="Body Text">PUBLIC Clipper: To be compatible with Visual Objects the special public variable, Clipper, is initialized to TRUE when created with PUBLIC.</para>
    <para styleclass="Body Text">Examples</para>
    <para styleclass="Body Text">This example creates two PUBLIC arrays and one PUBLIC variable:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aArray1[10, 10], var2</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aArray2[20][10]</text></para>
    <para styleclass="Body Text">The following PUBLIC statements create variables and initialize them with values:</para>
    <para styleclass="Code Example"><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> cString := Space(10), cColor := SetColor()</text><br/><text style="font-weight:bold; font-style:normal; color:#ff0000;">PUBLIC</text><text style="font-weight:normal; font-style:normal; color:#000000;"> aArray := {1, 2, 3}, ;</text><br/><text style="font-weight:normal; font-style:normal; color:#000000;">aArray2 := ArrayNew(12, 24)</text></para>
    <para styleclass="Heading2">See Also</para>
    <para styleclass="Body Text"><link displaytype="text" defaultstyle="true" type="topiclink" href="GLOBAL">GLOBAL</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="MEMVAR">MEMVAR</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="PARAMETERS2">PARAMETERS</link>, <link displaytype="text" defaultstyle="true" type="topiclink" href="PRIVATE">PRIVATE</link></para>
    <para styleclass="Body Text"></para>
  </body>
</topic>
