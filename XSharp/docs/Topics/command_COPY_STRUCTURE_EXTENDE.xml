<?xml version="1.0" encoding="UTF-8"?>
<topic template="Default" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">COPY STRUCTURE EXTENDED Command</title>
  <keywords>
    <keyword translate="true">Commands</keyword>
    <keyword translate="true">COPY STRUCTURE EXTENDED command</keyword>
    <keyword translate="true">Structures<keyword translate="true">copying</keyword></keyword>
    <keyword translate="true">Copying<keyword translate="true">structures</keyword></keyword>
    <keyword translate="true">Databases</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Normal"></para>
      <para styleclass="Code Example"><text styleclass="Normal" translate="true">&#32;</text><text styleclass="Heading1" translate="true">COPY STRUCTURE EXTENDED Command</text></para>
    </header>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Purpose</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Copy the field definitions in a database file structure to a structure-extended file as data.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Syntax</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">COPY STRUCTURE EXTENDED TO &lt;</text><text styleclass="Italic" translate="true">xcTargetFile</text><text styleclass="Normal" translate="true">&gt;</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Arguments</text></para>
    <para styleclass="List"><text styleclass="Normal" translate="true">TO &lt;</text><text styleclass="Italic" translate="true">xcTargetFile</text><text styleclass="Normal" translate="true">&gt;</text><tab /><text styleclass="Normal" translate="true">The name of the target structure-extended database file, including an optional drive, directory, and extension. &#160;See SetDefault() and SetPath() for file searching and creation rules. &#160;The default extension for database files is determined by the RDD (see the &quot;RDD Specifics&quot; appendix in the </text><text styleclass="Italic" translate="true">Programmer&apos;s Guide </text><text styleclass="Normal" translate="true">for details on a particular RDD).</text></para>
    <para styleclass="List"></para>
    <para styleclass="List"><tab /><text styleclass="Normal" translate="true">If &lt;</text><text styleclass="Italic" translate="true">xcTargetFile</text><text styleclass="Normal" translate="true">&gt; does not exist, it is created. &#160;If it exists, this command attempts to open the file in exclusive mode and, if successful, the file is overwritten without warning or error. &#160;If access is denied because, for example, another process is using the file, NetErr() is set to TRUE. &#160;Refer to the &quot;Concurrency Control&quot; chapter in the </text><text styleclass="Italic" translate="true">Programmer&apos;s Guide</text><text styleclass="Normal" translate="true"> for more information on resolving concurrency conflicts.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Description</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">COPY STRUCTURE EXTENDED creates a database file whose contents is the structure of the current database file, with a record for the definition of each field. &#160;</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The structure-extended database file has the following structure:</text></para>
    <para styleclass="Normal"></para>
    <para style="text-indent:-204px; margin-left:252px; tabstops:144px left,222px left,252px left,282px left ;"><text styleclass="Bold" translate="true">Field Name</text><tab /><text styleclass="Bold" translate="true">Type</text><tab /><text styleclass="Bold" translate="true">Length</text><tab /><text styleclass="Bold" translate="true">Decimals</text><tab /></para>
    <para style="text-indent:-204px; margin-left:252px; tabstops:144px left,222px left,252px left,282px left ;"><text styleclass="Normal" translate="true">Field_Name</text><tab /><text styleclass="Normal" translate="true">Character</text><tab /><text styleclass="Normal" translate="true">10</text><tab /><tab /></para>
    <para style="text-indent:-204px; margin-left:252px; tabstops:144px left,222px left,252px left,282px left ;"><text styleclass="Normal" translate="true">Field_Type</text><tab /><text styleclass="Normal" translate="true">Character</text><tab /><text styleclass="Normal" translate="true">1</text><tab /><tab /></para>
    <para style="text-indent:-204px; margin-left:252px; tabstops:144px left,222px left,252px left,282px left ;"><text styleclass="Normal" translate="true">Field_Len</text><tab /><text styleclass="Normal" translate="true">Numeric</text><tab /><text styleclass="Normal" translate="true">3</text><tab /><tab /><text styleclass="Normal" translate="true">0</text></para>
    <para style="text-indent:-204px; margin-left:252px; tabstops:144px left,222px left,252px left,282px left ;"><text styleclass="Normal" translate="true">Field_Dec</text><tab /><text styleclass="Normal" translate="true">Numeric</text><tab /><text styleclass="Normal" translate="true">3</text><tab /><tab /><text styleclass="Normal" translate="true">0</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Used in application programs, COPY STRUCTURE EXTENDED permits you to create or modify the structure of a database file programmatically. &#160;To create a new database file from the structure-extended file, use CREATE FROM. &#160;If you need an empty structure-extended file, use CREATE.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Notes</text></para>
    <para styleclass="Normal"><text styleclass="BoldItalic" translate="true">Character field lengths greater than 255: &#160;</text><text styleclass="Normal" translate="true">Field lengths greater than 255 are represented as a combination of the Field_Dec and Field_Len fields. &#160;After performing COPY STRUCTURE EXTENDED, you can use the following formula to determine the length of any character field:</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">nFieldLen </text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">:=</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true"> IIf</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">((</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">Field_Type </text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">=</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">&#32;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">&quot;C&quot;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">&#32;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">.</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">AND</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">.</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true"> &#160;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">;</text></para>
    <para styleclass="Code Example"><tab /><tab /><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">Field_Dec </text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">!=</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">&#32;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">0),</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true"> Field_Dec </text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">*</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">&#32;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">256</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">&#32;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">+</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">&#32;</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">;</text></para>
    <para styleclass="Code Example"><tab /><tab /><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true">Field_Len</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">,</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#000000;" translate="true"> Field_Len</text><text styleclass="Code Example" style="font-weight:bold; font-style:normal; color:#0000ff;" translate="true">)</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Examples</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">This example creates STRUC.DBF from SALES.DBF as a structure-extended file, then lists the contents of STRUC.DBF to illustrate the typical layout of field definitions:</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">USE sales NEW</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">COPY STRUCTURE EXTENDED TO struc</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">USE struc NEW</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">LIST Field_Name, Field_Type, Field_Len, Field_Dec</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">// Result:</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">1 BRANCH</text><tab /><tab /><tab /><text styleclass="Code Example" translate="true">C</text><tab /><tab /><text styleclass="Code Example" translate="true">3</text><tab /><tab /><text styleclass="Code Example" translate="true">0</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">2 SALESMAN</text><tab /><tab /><text styleclass="Code Example" translate="true">C</text><tab /><tab /><text styleclass="Code Example" translate="true">4</text><tab /><tab /><text styleclass="Code Example" translate="true">0</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">3 CUSTOMER</text><tab /><tab /><text styleclass="Code Example" translate="true">C</text><tab /><tab /><text styleclass="Code Example" translate="true">4</text><tab /><tab /><text styleclass="Code Example" translate="true">0</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">4 PRODUCT</text><tab /><tab /><tab /><text styleclass="Code Example" translate="true">C</text><tab /><tab /><text styleclass="Code Example" translate="true">25</text><tab /><tab /><text styleclass="Code Example" translate="true">0</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">5 AMOUNT</text><tab /><tab /><tab /><text styleclass="Code Example" translate="true">N</text><tab /><tab /><text styleclass="Code Example" translate="true">8</text><tab /><tab /><text styleclass="Code Example" translate="true">2</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">6 NOTES</text><tab /><tab /><tab /><text styleclass="Code Example" translate="true">C</text><tab /><tab /><text styleclass="Code Example" translate="true">0</text><tab /><tab /><text styleclass="Code Example" translate="true">125</text></para>
    <para styleclass="Code Example"><text styleclass="Code Example" translate="true">// Field length is 32,000 characters</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">Library</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">System Library</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"><text styleclass="Heading1" translate="true">See Also</text></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="command_COPY_STRUCTURE" styleclass="Normal" translate="true">COPY STRUCTURE</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_CREATE" styleclass="Normal" translate="true">CREATE</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="command_CREATE_FROM" styleclass="Normal" translate="true">CREATE FROM</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Function_FieldName" styleclass="Normal" translate="true">FieldName()</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Function_DBCopyXStruct" styleclass="Normal" translate="true">DBCopyXStruct()</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Function_SetDefault" styleclass="Normal" translate="true">SetDefault()</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Function_SetPath" styleclass="Normal" translate="true">SetPath()</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Function_Type" styleclass="Normal" translate="true">Type()</link></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
