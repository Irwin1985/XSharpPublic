<?xml version="1.0" encoding="utf-8"?>
<!-- Licensed to the .NET Foundation under one or more agreements. The .NET Foundation licenses this file to you under the MIT license. See the LICENSE file in the project root for more information. -->
<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="$(Solutiondir)src\Compiler\CompilerCommon.props" />
  <Import Project="$(RepositoryEngineeringDir)targets\GenerateCompilerExecutableBindingRedirects.targets" />
  <PropertyGroup>
    <OutputType>Library</OutputType>
    <TargetFrameworks>netcoreapp3.1;netstandard2.0</TargetFrameworks>
    <RootNamespace>Microsoft.CodeAnalysis.CSharp</RootNamespace>
    <AssemblyName>CSharp.CodeAnalysis</AssemblyName>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <DefineConstants>$(DefineConstants);COMPILERCORE;XSHARPPRE</DefineConstants>
    <CodeAnalysisRuleSet>$(CSharpSource)..\CSharpCodeAnalysisRules.ruleset</CodeAnalysisRuleSet>
    <NoStdLib>true</NoStdLib>
    <GenerateMicrosoftCodeAnalysisCommitHashAttribute>true</GenerateMicrosoftCodeAnalysisCommitHashAttribute>
    <ApplyNgenOptimization Condition="'$(TargetFramework)' == 'netstandard2.0'">partial</ApplyNgenOptimization>
  </PropertyGroup>
<ItemGroup>
    <!--
      Analyzers that will be used to analyze projects that references 
      Microsoft.CodeAnalysis project or Microsoft.CodeAnalysis.Common package.
      
      Note: PrivateAssets="ContentFiles" ensures that projects referencing Microsoft.CodeAnalysis.Common package 
      will import everything but content files from Microsoft.CodeAnalysis.Analyzers, specifically, analyzers.
    -->
    <PackageReference Include="Microsoft.CodeAnalysis.Analyzers" Version="$(MicrosoftCodeAnalysisAnalyzersVersion)" Condition="'$(DotNetBuildFromSource)' != 'true'" PrivateAssets="ContentFiles" />
    <PackageReference Include="System.Collections.Immutable" Version="$(SystemCollectionsImmutableVersion)" />
    <PackageReference Include="System.Memory" Version="$(SystemMemoryVersion)" />
    <PackageReference Include="System.Reflection.Metadata" Version="$(SystemReflectionMetadataVersion)" />
    <PackageReference Include="System.Runtime.CompilerServices.Unsafe" Version="$(SystemRuntimeCompilerServicesUnsafeVersion)" />
    <PackageReference Include="System.Threading.Tasks.Extensions" Version="$(SystemThreadingTasksExtensionsVersion)" />
    <PackageReference Include="System.Text.Encoding.CodePages" Version="$(SystemTextEncodingCodePagesVersion)" />
  </ItemGroup>  
  <ItemGroup>
    <Compile Include="$(CoreSource)..\..\Shared\CoreClrShim.cs" Link="InternalUtilities\CoreClrShim.cs" />
 
  </ItemGroup>
  <ItemGroup>
    <Content Include="$(CSharpSource)BoundTree\BoundNodes.xml" />
    <None Include="$(CSharpSource)BoundTree\BoundNodes.xsd" />
    <None Include="$(CSharpSource)Generated\CSharp.Generated.g4" />
    <Content Include="$(CSharpSource)Syntax\Syntax.xml" />
    <None Include="$(CSharpSource)SSyntax\Syntax.xsd" />
    <Content Include="$(CSharpSource)UseSiteDiagnosticsCheckEnforcer\BaseLine.txt" />
    <Content Include="$(CSharpSource)UseSiteDiagnosticsCheckEnforcer\Run.bat" />
    <None Include="$(CSharpSource)FlowAnalysis\Flow Analysis Design.docx" />
    <None Include="$(CSharpSource)..\CSharpCodeAnalysisRules.ruleset">
      <SubType>Designer</SubType>
    </None>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Update="CSharpResources.resx" GenerateSource="true" />
    <EmbeddedResource Update="CodeAnalysisResources.resx" GenerateSource="false" />
    <EmbeddedResource Include="$(CoreSource)Resources\default.win32manifest" />
  </ItemGroup>
  <ItemGroup>
  	<Compile Include="$(CSharpSource)**\*.cs">
		<Link>CSharp\%(RecursiveDir)\%(Filename)%(Extension)</Link>
	  </Compile>
    <Compile Include="$(CoreSource)**\*.cs">
		<Link>Core\%(RecursiveDir)\%(Filename)%(Extension)</Link>
      </Compile>
  </ItemGroup>
  <ItemGroup>
    <None Include="$(CoreSource)..\CodeAnalysisRules.ruleset">
      <SubType>Designer</SubType>
    </None>
    <None Include="$(CoreSource)RuleSet\RuleSetSchema.xsd">
      <SubType>Designer</SubType>
    </None>
  </ItemGroup>
  <Import Project="$(CSharpSource)..\CSharpAnalyzerDriver\CSharpAnalyzerDriver.projitems" Label="Shared" />
  <Import Project="$(CoreSource)..\AnalyzerDriver\AnalyzerDriver.projitems" Label="Shared" />
  <Import Project="$(CoreSource)..\..\..\Dependencies\CodeAnalysis.Debugging\Microsoft.CodeAnalysis.Debugging.projitems" Label="Shared" />
  <Import Project="$(CoreSource)..\..\..\Dependencies\PooledObjects\Microsoft.CodeAnalysis.PooledObjects.projitems" Label="Shared" />
  <ItemGroup>
    <AdditionalFiles Remove="C:\XSharp\Dev\XSharp\build\Targets\..\config\BannedSymbols.txt" />
  </ItemGroup>
  <ItemGroup>
    <AdditionalFiles Remove="C:\XSharp\Dev\XSharp\build\Targets\..\config\BannedSymbols.txt" />
  </ItemGroup>
  <ItemGroup>
    <None Remove="C:\XSharp\Dev\XSharp\..\Roslyn\Src\Compilers\CSharp\Portable\SSyntax\Syntax.xsd" />
  </ItemGroup>
</Project>